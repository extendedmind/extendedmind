<div class="container-fluid" ng-controller="NoteEditorController" ng-class="note.deleted && 'container-disabled'">
  <header class="container-titlebar">
    <div class="container-titlebar--inner">
      <div class="group-symmetrical height-large">
        <a href class="group-symmetrical--left link-navigation highlighted active" ng-click="endNoteEdit()" >
          <span class="text-navigation-back" ng-class="!isFirstSlide() && 'not-swipeable'"
            ng-bind="isNoteEdited() && !note.deleted ? 'save' : 'back'"></span>
        </a>
        <div ng-hide="onboardingInProgress" ng-if="mode === 'fullScreen'"
          class="group-symmetrical--middle width-large animate-fade-in-out">
          <a href class="link-navigation downplayed" ng-click="toggleNoteEditMode()">
            <span class="text-navigation">note settings</span>
          </a>
        </div>
        <a href ng-if="!note.deleted && !onboardingInProgress" class="group-symmetrical--right"
          ng-click="deleteNoteInEdit()"><span class="icon-trash"></span></a>
        <a href ng-if="note.deleted && !onboardingInProgress"
          class="group-symmetrical--right link-navigation highlighted active"
          ng-click="undeleteNote(note)"><span class="text-navigation">restore</span></a>
      </div>

      <!-- NOTE TITLE -->
      <div ng-hide="hideNoteTitle && isOnboarded('notes')" class="row-vertically-centered with-textarea">
        <textarea ng-hide="isTitleClamped()" class="text-heading-primary" ng-model="note.trans.title"
          input-model-validator ng-trim="false"
          ng-keydown="noteTitlebarTextKeyDown($event)" ng-focus="noteTitleFocused()" editable-field
          editable-field-register-callbacks="registerTitleBarInputCallbacks(focus, blur)" msd-elastic
          placeholder="enter note title&#8230;" maxlength="128"
          autocapitalize="none" autocorrect="off">
        </textarea>

        <div ng-if="isTitleClamped()">
          <span class="text-heading-primary" ng-class="{'text-downplayed': !note.trans.title}"
            ng-bind="note.trans.title ? note.trans.title : 'enter note title&#8230;'" clamp=2></span>
        </div>
      </div>

      <div ng-if="!isOnboarded('notes') && checkListOnboardingLock('notes', 'on')">
        <div ng-show="!noteTitlebarHasText()" class="text-details row">
          e.g. reading suggestions, budget meeting minutes, summer plans
        </div>
        <div ng-show="noteTitlebarHasText() && !hideNoteTitle" class="text-details row">when done, hit return</div>
       </div>
     </div>
   </header>

   <div class="swiper-container container-fluid--inner" swiper-container="noteEditor" swiper-type="main"
    expected-slides="2" swiper-container-slide-changed="editorSwiperSlideChanged()">
    <div class="swiper-wrapper" ng-class="onboardingInProgress && 'swiper-no-swiping'">
      <div class="swiper-slide" swiper-slide="noteEditor/basic" slide-index="0">
        <div ng-style="{'padding-bottom': mode === 'fullScreen' ? 0 : EDITOR_FOOTER_HEIGHT}"
        class="container-content" drawer-override-aisle="right" swiper-prevent>

          <!-- LIST PICKER -->
          <div ng-if="listPickerOpen" ng-hide="onboardingInProgress" class="swiper-no-swiping animate-fade-in"
            editable-field-container="auto" editable-field-container-scrollable="true"
              editable-field-container-clicked-elsewhere="closeListPicker()" data-snap-ignore="true">
            <div list-picker="lists" list-picker-new-item="getNewList()"
              list-picker-archived-lists="archivedLists"
              list-picker-save="closeListPickerAndSetListToItem(note, list)"
              list-picker-clear="closeListPickerAndClearListFromItem(note, list)"
              list-picker-selected="note.trans.list"></div>
          </div>

          <div ng-if="!listPickerOpen">
            <div ng-hide="mode === 'fullScreen'" class="row-vertically-centered">
              <a href ng-class="note.trans.list ? 'link' : 'downplayed'" ng-click="openListPicker()">
                <span class="text-link" ng-bind="note.trans.list ? note.trans.list.trans.title : 'select list\u2026'"></span>
              </a>
            </div>

            <!-- URL -->
            <div ng-hide="mode === 'fullScreen'" class="row-vertically-centered with-textarea">
              <textarea ng-model="note.trans.link" input-model-validator ng-trim="false" msd-elastic
                maxlength="128" placeholder="enter url&#8230;" autocapitalize="none" autocorrect="off">
              </textarea>
            </div>

            <!-- CONTENT -->
            <div class="row-vertically-centered with-textarea">
              <textarea ng-class="(!isOnboarded('notes') && checkListOnboardingLock('notes', 'on') && !hideNoteTitle) && 'input-separate'"
                ng-model="note.trans.content" input-model-validator ng-focus="noteContentFocused()"
                msd-elastic editable-field ng-trim="false"
                editable-field-register-callbacks="registerNoteContentInputCallbacks(focus, blur)"
                placeholder="enter content&#8230;" autocapitalize="none" autocorrect="off">
              </textarea>
            </div>

            <div ng-if="!isOnboarded('notes') && checkListOnboardingLock('notes', 'on')">
              <div ng-if="note.trans.content.length" class="text-details row">when done, save your note by
                clicking 'save' in the top-left corner or swipe left
              </div>
            </div>
          </div>
        </div>

        <footer ng-hide="isNoteFooterHidden()" class="container-content--after editor-footer animate-fade-in-out">
          <nav role="navigation" class="swiper-no-swiping group-symmetrical">
            <a href ng-hide="onboardingInProgress" ng-click="clickFavorite()" class="group-symmetrical--left">
              <span class="icon-star" ng-class="!note.trans.favorited && 'inactive'"></span>
            </a>
            <a href ng-click="swipeToAdvanced()" ng-hide="isFooterNavigationHidden()"
              class="group-symmetrical--right link-navigation">
              <span class="text-navigation-forward">advanced</span>
            </a>
          </nav>
        </footer>
      </div>

      <div class="swiper-slide" swiper-slide="noteEditor/advanced" slide-index="1" ng-init="advancedSlideInfo = {}">
        <div ng-style="{'padding-bottom': advancedSlideInfo.footerHeight}" class="container-content"
        swiper-prevent>

          <!-- KEYWORDS -->
          <form role="form" class="row-form" ng-submit="addNewKeywordToNote(note, newKeyword)"
            autocapitalize="none" autocorrect="off">
            <input type="text" ng-model="newKeyword.trans.title" placeholder="add keyword&#8230;" maxlength="128">
          </form>
          <span class="text-details row" ng-if="newKeyword.trans.title"
            ng-bind="'hit enter to create #' + newKeyword.trans.title" clamp=2>
          </span>

          <div ng-if="noteHasKeywords(note)" class="keywords-container row">
            <div class="keyword-wrapper" ng-repeat="keyword in note.trans.keywords | orderBy:'trans.title'">
              <a href class="keyword highlighted" ng-click="removeKeywordFromNote(note, keyword)">
                <span class="text-keyword" ng-bind="'#' + keyword.trans.title" clamp=1></span>
              </a>
            </div>
          </div>

          <div ng-if="keywords" class="keywords-container row">
            <div class="keyword-wrapper"
              ng-repeat="keyword in keywords
              | keywordsFilter:{name:'byOtherThanNoteKeywords', item: note}
              | filter:newKeyword.trans.title
              | orderBy:'trans.title'">
              <a href class="keyword link" ng-click="addKeywordToNote(note, keyword)">
                <span class="text-keyword" ng-bind="'#' + keyword.trans.title" clamp=1></span>
              </a>
            </div>
          </div>

        </div>
        <footer ng-hide="isNoteFooterHidden()" class="container-content--after editor-footer"
          editor-footer="advancedSlideInfo">

          <div class="table">
            <div class="table-row">
              <a href class="table-cell link" ng-click="convertToTask(note)">
                <span class="text-convert">task</span>
              </a>
              <a href class="table-cell link" ng-click="convertToList(note)">
                <span class="text-convert">list</span>
              </a>
            </div>
          </div>

          <nav role="navigation" class="swiper-no-swiping group-symmetrical">
            <a href ng-click="swipeToBasic()" ng-hide="isFooterNavigationHidden()"
              class="group-symmetrical--left link-navigation">
              <span class="text-navigation-back">basic</span>
            </a>
          </nav>
        </footer>
      </div>
    </div>
  </div>
</div>
