# From https://github.com/google/cargo-raze#remote-dependency-mode
[package]
name = "compile_with_bazel"
version = "0.0.0"

# Mandatory (or Cargo tooling is unhappy)
[lib]
path = "fake_lib.rs"

[dependencies]
automerge = { git = "https://github.com/automerge/automerge-rs.git", rev = "bba4fe2c36a165f0513d0c2751b35a5cb1acbda5", features=["wasm"] }
duct = "=0.13.4"
hypercore-protocol = { git = "https://github.com/ttiurani/hypercore-protocol-rs", branch = "v10", features = ["wasm-bindgen"] }
async-tungstenite = { version = "0.13.1", features = ["async-std-runtime"] }
bytes = "0.5.0"
fern = "0.6.0"
log = "0.4.14" # See below for hack to get the dependency value-bag to work with build.rs
anyhow = "1.0.33"
clap = { version = "3.0.0-rc.5", features = ["derive"] } # See below for hack to get #![doc = include_str!("../README.md")] to work
chrono = { version = "0.4.19" }
futures = "^0.3.5"
async-std = { version = "1.9.0", features = ["unstable"] }
async-attributes = "1.1.2"
async-trait = "0.1.51"
tide = "0.16.0"
tide-websockets = "0.4.0"
tide-compress = "0.10.2"
tide-rustls = { git = "https://github.com/http-rs/tide-rustls", rev = "cbfb61f519238730b4d6318901fe2f2a8bfdb164" }
tide-acme = { git = "https://github.com/ttiurani/tide-acme", rev = "53c21b421b2443c3c02487b49f3c7f32c64febb0" }
moka = { version = "0.8.4", default-features = false, features = ["atomic64", "future"] }
wildmatch = "2.1.0"
serde = "1.0.137"
tar = "0.4.38"
flate2 = "1.0.24"
age = { version = "0.8.1", features = ["ssh", "cli-common"] }
lettre = { version = "0.10.0-rc.7", default-features = false, features = ["smtp-transport", "rustls-tls", "hostname", "builder"] }
html-escape = "0.2.11"
ctrlc = { version = "3.0", features = ["termination"] }
async-ctrlc = "1.2.0"
thread-priority = "0.8.2"
random-access-storage = { git = "https://github.com/ttiurani/random-access-storage", branch = "v10" }
random-access-memory = { git = "https://github.com/ttiurani/random-access-memory", branch = "v10" }
random-access-disk = { git = "https://github.com/ttiurani/random-access-disk", branch = "v10" }
hex = "0.4"
reusable-box-future = "0.2.0"
derivative = "2.2.0"
capnp = "0.14.5"
smol_str = "0.1.18"
# Wasm dependencies
# NOTE: This version needs to match that of rules_rust
wasm-bindgen = "=0.2.78" # See below for hack to get #![doc = include_str!("../README.md")] to work
wasm-bindgen-futures = "0.4.28"
ws_stream_wasm = "0.7.3" # See below two hacks to get #![doc = include_str!("../README.md")] to work
js-sys = "0.3.55"
console_error_panic_hook = "0.1.7"
console_log = "0.2.0"
# Android dependencies
jni = "0.19.0"

# Needed for log to build
[package.metadata.raze.crates.value-bag.'1.0.0-alpha.8']
gen_buildrs = false
override_rustc_flags = """
    [ "--cap-lints=allow" ] +
    selects.with_or({
        (
            "@rules_rust//rust/platform:wasm32-unknown-unknown",
        ): ["--cfg=value_bag_capture_fallback"],
        "//conditions:default": ["--cfg=value_bag_capture_ctor"],
    })
"""

# Needed for libc to build
[package.metadata.raze.crates.cpufeatures.'0.2.2']
override_deps = """
    [
    ] + selects.with_or({
        # aarch64-linux-android
        (
            "@rules_rust//rust/platform:aarch64-linux-android",
            "@rules_rust//rust/platform:aarch64-unknown-linux-gnu",
        ): [
            "@raze__libc__0_2_137//:libc",
        ],
        "//conditions:default": [],
    })
"""

# Needed for libc to build
[package.metadata.raze.crates.thread-priority.'0.8.2']
override_deps = """
    [
        "@raze__cfg_if__1_0_0//:cfg_if",
        "@raze__log__0_4_17//:log",
    ] + selects.with_or({
        # cfg(any(target_os = "linux", target_os = "macos", target_os = "dragonfly", target_os = "freebsd", target_os = "openbsd", target_os = "netbsd"))
        (
            "@rules_rust//rust/platform:x86_64-apple-darwin",
            "@rules_rust//rust/platform:x86_64-unknown-linux-gnu",
            "@rules_rust//rust/platform:aarch64-unknown-linux-gnu",
            "@rules_rust//rust/platform:x86_64-pc-windows-msvc",
        ): [
            "@raze__libc__0_2_137//:libc",
        ],
        "//conditions:default": [],
    }) + selects.with_or({
        # cfg(windows)
        (
            "@rules_rust//rust/platform:x86_64-pc-windows-msvc",
        ): [
            "@raze__winapi__0_3_9//:winapi",
        ],
        "//conditions:default": [],
    })
"""

# Needed for clap to build
[package.metadata.raze.crates.clap.'3.0.0-rc.5']
compile_data_attr = "glob([\"README.md\",\"examples/demo.md\"])"
[package.metadata.raze.crates.clap_derive.'3.0.0-rc.5']
compile_data_attr = "glob([\"README.md\"])"

# Needed for ws_stream_wasm to build
[package.metadata.raze.crates.pharos.'0.5.3']
compile_data_attr = "glob([\"README.md\"])"
[package.metadata.raze.crates.async_io_stream.'0.3.3']
compile_data_attr = "glob([\"README.md\"])"

# Needed for wasm-bindgen to build
[package.metadata.raze.crates.bumpalo.'3.9.1']
compile_data_attr = "glob([\"README.md\"])"

# Needed for hypercore to build
[package.metadata.raze.crates.ed25519.'1.4.1']
compile_data_attr = "glob([\"README.md\"])"
[package.metadata.raze.crates.signature.'1.6.4']
compile_data_attr = "glob([\"README.md\"])"
[package.metadata.raze.crates.const-oid.'0.9.0']
compile_data_attr = "glob([\"README.md\"])"
[package.metadata.raze.crates.base64ct.'1.5.3']
compile_data_attr = "glob([\"README.md\"])"
[package.metadata.raze.crates.chacha20poly1305.'0.10.1']
compile_data_attr = "glob([\"README.md\"])"
[package.metadata.raze.crates.der.'0.6.0']
compile_data_attr = "glob([\"README.md\"])"
[package.metadata.raze.crates.spki.'0.6.0']
compile_data_attr = "glob([\"README.md\"])"
[package.metadata.raze.crates.pkcs8.'0.9.0']
compile_data_attr = "glob([\"README.md\"])"
[package.metadata.raze.crates.pkcs1.'0.4.1']
compile_data_attr = "glob([\"README.md\"])"

# Needed for ring to build
[package.metadata.raze.crates.ring.'*']
compile_data_attr = "glob([\"**/*.der\"])"
[package.metadata.raze.crates.webpki.'*']
compile_data_attr = "glob([\"**/*.der\"])"

# Needed for age to build
[package.metadata.raze.crates.age.'*']
compile_data_attr = "glob([\"Cargo.toml\",\"i18n.toml\",\"i18n/**/*.*\",\"assets/**\"])"

[package.metadata.raze]
workspace_path = "//third_party/cargo"
package_aliases_dir = "."
genmode = "Remote"
default_gen_buildrs = true
targets = [
    "x86_64-apple-darwin",
    "x86_64-pc-windows-msvc",
    "x86_64-unknown-linux-gnu",
    "wasm32-unknown-unknown",
    "aarch64-unknown-linux-gnu",
    "aarch64-linux-android",
    "arm-linux-androideabi",
    "i686-linux-android",
    "x86_64-linux-android",
]
